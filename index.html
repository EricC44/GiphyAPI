<!doctype html>
<html lang="en">
  <head>
    <title>Sports API Giphy</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  </head>
  <body>
      <div id="container">
          <div class="row">
            <button type="button" class= "btn btn-info btn-lg" data-sports="Baseball">Homerun!</button>
            <button type="button" class= "btn btn-info btn-lg" data-sports="FootBall">Touchdown!</button>
            <button type="button" class= "btn btn-info btn-lg" data-sports="BasketBall">Buzzer Beater!</button>
            <button type="button" class= "btn btn-info btn-lg" data-sports="Hockey">Goal!</button>
            <button type="button" class= "btn btn-info btn-lg" data-sports="Golf">Hole in One!</button>
            <button type="button" class= "btn btn-info btn-lg" data-sports="Soccer">GOOOOOOOAL!</button>
          </div>
        <div class="row">
          <div class="col-md-8">
            <div id="gifs"></div>
          </div>

          <div class="col">
            <form class="form-inline" id="GiphySearch">
              <div class="form-group">
                <label for="SearchBar">Sports Search</label>
                <input type="text" id="sportSearch" class="form-control">
               
              </div>
              <!-- This is crucial in inputting sports related gifs into our webpage -->
              <button type="submit" class="btn btn-success btn-lg">Submit</button>
            </form>
          </div>
        </div>
      
      <!--Javascript Starts -->

        <script type="text/javascript">
        //Some global variables before we start coding
        var topics = [""]
        //we first want to make the container reactive to the click event
        document.querySelector("#container").addEventListener("click" , function(event) {
          //We are seeing if the browser can support fetch command.
          if(window.fetch) {
            //storing the value of dataset sports in the button
            if(event.target.tagName == "BUTTON") {
              var sport = event.target.dataset.sports
              //This is a var to get the api itself and sending it parameters on what to pull.
              var queryURL = `https://api.giphy.com/v1/gifs/search?q="${sport}&api_key=LSLq3tnjyYxCRRP5WmWRntKPPOXEYSlW&limit=10`;
             //This is to request information from the queryURL server
            fetch(queryURL, {
              method: "GET"
            })
              //This is the AJAX data that should come back to me
              .then(function(response) {
                return response.json(); 
              })
              .then(function (response) {

                console.log(queryURL);

                console.log(response);
                //Setting the AJAX data returned to "result"
                var result = response.data;
                //Looping function for every result
                for(let pic of result) {
                  
                  
                  //Making sure that images with a pg-13 or r rated tag will be removed
                  if(pic.rating !== "r" && pic.rating !== "pg-13") {
                    
                    //Creating a div to fit our gifs
                    var sportsDiv = document.createElement("div");
                    //Storing the rating of the gif
                    var rating = pic.rating;

                    //this creates a "p" tag and are creating text for that p value
                    var p = document.createElement("p");
                    p.innerText = `Rating: ${rating}`;
                    //Creating the image tag
                    var sportsImage = document.createElement("img");
                    //Giving each of the images a "src" tag and setting each image to a default height
                    sportsImage.setAttribute("src" , pic.images.fixed_height.url);
                    //Apending the paragraph and image tags to our sports div
                    sportsDiv.appendChild(p);
                    sportsDiv.appendChild(sportsImage);
                    //prepending the div to the container
                    let gifsContainer = document.querySelector("#gifs");
                    gifsContainer.insertBefore(sportsDiv , gifsContainer.firstChild);
                    
                  }
                  //This is our event listener to 
                  document.querySelector("#gifs").addEventListener("click", function(event) {
                    if(event.target.tagName === "img".toUpperCase()) {

                      let sportsImage = event.target;

                      var state = sportsImage.dataset.state;

                      var stillURL = result.images.fixed_height_still.url;
                      var playURL = result.images.fixed_height_height.url;

                      if(state === "still") {

                        sportsImage.setAttribute("src" , sportsImage.dataset.playURL);
                        sportsImage.setAttribute("data-state" , "animate")
                      }

                      else {
                      
                        sportsImage.setAttribute("src" , sportsImage.dataset.stillURL);
                        sportsImage.setAttribute("data-state" , "still");
                      }

                  }

                  });

                }





















            















              });





























            }












          }
          //This is in case the browser does not support the fetch method
          else {
            //This is to create a new xhr object
            const xhr = new XMLHttpRequest();
            //Setting up a "GET" request to the queryURL
            xhr.open("GET", queryURL);
































          }
            
        })
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        </script>
      </div> 
  </body>
</html>